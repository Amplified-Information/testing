syntax = "proto3";

package clob;

service Clob {
  rpc PlaceOrder (OrderRequest) returns (OrderResponse);
  rpc GetBook (BookRequest) returns (BookSnapshot);
  rpc StreamBook (BookRequest) returns (stream BookSnapshot);
}

message OrderRequest {
  string owner = 1;
  bool is_buy = 2;
  uint64 price = 3;
  uint64 amount = 4;
  int64 timestamp_ns = 5; // Hedera nanoseconds since epoch
  string tx_hash = 6;
}

message OrderResponse {
  string status = 1;
  string error = 2;
}

message BookRequest {
  uint32 depth = 1;
}

message BookSnapshot {
  repeated PriceLevel bids = 1;
  repeated PriceLevel asks = 2;
}

message PriceLevel {
  uint64 price = 1;
  uint32 count = 2;
}
